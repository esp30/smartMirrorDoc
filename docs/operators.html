<!DOCTYPE HTML>
<html lang="en">

  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no">

    <!-- Page Info -->
    <title>For Operations | Smart Mirror </title>

    <!-- Social tags -->
    <meta name="keywords" content="">
    <meta name="description" content="Make your life easier">
    
    <!-- Fonts and icons -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">

    <!-- CSS Files -->
    <link href="assets/css/material-kit.css?v=2.0.5" rel="stylesheet">
          
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon//favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon//favicon-16x16.png">
    <link rel="manifest" href="assets/images/favicon//site.webmanifest">
    <link rel="mask-icon" href="assets/images/favicon//safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    
  </head>

<body data-spy="scroll" data-target="#toc">
  <!-- Navbar  -->
  <nav class="navbar navbar-color-on-scroll navbar-transparent fixed-top navbar-expand-lg" color-on-scroll="100">
      <div class="container">
        <div class="navbar-translate">
          <!-- Begin Logo -->
          <a class="navbar-brand" href="https://esp30.github.io/smartMirrorDoc/">
            <!-- <img src="assets/images/logo/logo.png" alt="">  -->
            <i class="material-icons">video_label</i> Smart Mirror 
          </a>
          <!-- End Logo -->
          
          <!-- Mobile -->
          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
        
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav ml-auto">
            <!-- Getting Started -->
            
            <li class="nav-item dropdown">
            
              <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                <i class="material-icons">explore</i> Getting Started
              </a>
              <div class="ripple-container"></div></a>
              <div class="dropdown-menu dropdown-with-icons">
<!--                 <a href="https://esp30.github.io/smartMirrorDoc/client.html" class="dropdown-item">
                  <i class="material-icons">explore</i> Getting Started
                </a>
                <a href="https://esp30.github.io/smartMirrorDoc/features.html" class="dropdown-item">
                  <i class="material-icons">toc</i> Features
                </a> -->
                <a href="https://esp30.github.io/smartMirrorDoc/getting-started.html" class="dropdown-item">
                  <i class="material-icons">person</i> Personas + Scenarios
                </a>
              </div>
            </li>
            
            <!-- The System -->            
             
            <li class="active nav-item dropdown">
            
              <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                <i class="material-icons">build</i> The System
              <div class="ripple-container"></div></a>
              <div class="dropdown-menu dropdown-with-icons">
                <a href="https://esp30.github.io/smartMirrorDoc/architecture.html" class="dropdown-item">
                  <i class="material-icons">dns</i> Architecture
                </a>
                <a href="https://esp30.github.io/smartMirrorDoc/developers.html" class="dropdown-item">
                  <i class="material-icons">book</i> For Developers
                </a>
                <a href="https://esp30.github.io/smartMirrorDoc/operators.html" class="dropdown-item">
                  <i class="material-icons">construction</i> For Operators
                </a>
                <a href="https://esp30.github.io/smartMirrorDoc/tests.html" class="dropdown-item">
                  <i class="material-icons">assignment_turned_in</i> Testing
                </a>
              </div>
            </li>

                    
            <!-- Team -->
            
            <li class="nav-item">
            
              <a href="https://esp30.github.io/smartMirrorDoc/team.html" class="nav-link">
                <i class="material-icons">supervisor_account</i> Team and Conclusions
              </a>
            </li>
           
          </ul>
        </div>
      </div>
    </nav>

  <!-- Content -->
  <!-- Header -->

<div class="page-header header-filter clear-filter purple-filter" data-parallax="true" style=" background: rgb(25, 39, 160); height: 500px; background-image: url('https://esp30.github.io/smartMirrorDoc/assets/images/operations.jpg'); background-position: center; ">

  <div class="container">
    <div class="row">
      <div class="col-md-8 ml-auto mr-auto">
        <div class="brand text-center">
          <h1 data-toc-skip>For Operations</h1>
          <h3 class="title text-center" data-toc-skip> Details on the operations perspective </h3>
          
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Content -->
<div class="main main-raised">
  <div class="container">
    <div class="section">
      <div class="row">
        
        <div class="col">
            <h5 data-toc-skip>Table of Contents</h5>
            <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
          </div>
          
          <div id="content" class="col-lg-10">
              <div id="diagram">
    <div class="title">
    <h2>The Continuous Deployment Pipeline on Jenkins</h2>
    </div>

    <img class="center" src="assets/images/jenkins-pipeline.png" alt="SmartMirror Pipeline on Jenkins" style="max-width:100%;
    max-height:100%;"></img>
    <p class="text-muted" style="text-align: center">
        SmartMirror Pipeline on Jenkins
    </p>
</div>

<div id="details">
    <div class="title">
        <h3>Modes of execution</h3>
        <h4>The SmartMirror pipeline is parameterized. It can be run in three different modes:
        </h4>
    </div>
            
    <!--Table-->
    <table id="tablePreview" class="table" style="table-layout:fixed">
        <!--Table head-->
        <thead>
        <tr>
            <th>Mode</th>
            <th>Explanation</th>
        </tr>
        </thead>
        
        <tbody>
            
            <tr>
                <th scope="row">Test</th>
                <td>Only executes the test related steps of the pipeline, such as Test, Cucumber tests. This allows us to run our integration tests quickly, without deploying the app. </td>
            </tr>
            
            <tr>
                <th scope="row">Deploy</th>
                <td>Only executes the deployment related steps of the pipeline, such as Deploy to Artifactoy, Deploy back-end, Deploy Doctor App and Deploy on runtime. This allows us to deploy the app while skipping all tests. </td>
            </tr>
            
            <tr>
                <th scope="row">Test+Deploy</th>
                <td>Executes the full pipeline. </td>
            </tr>
            
        </tbody>
    </table>
</div>

<div id="details">
    <div class="title">
        <h3>Details on each stage</h3>
        <h4>Used plugins, executed tasks, used tools</h4>
    </div>
            
    <!--Table-->
    <table id="tablePreview" class="table" style="table-layout:fixed">
        <!--Table head-->
        <thead>
        <tr>
            <th>Stage</th>
            <th>Purpose</th>
            <th>Used tools</th>
            <th>Runs on modes</th>
        </tr>
        </thead>
        
        <tbody>
            
            <tr>
                <th scope="row">Test</th>
                <td>This steps executes some preliminary testing, such as checking if the remote runtime server is active. This is so the new build stops before executing some of the most performance heavy steps in case there’s something wrong with the deployment server. </td>
                <td>SSH command </td>
                <td>Test + Deploy <br> Test</td>
            </tr>
            
            <tr>
                <th scope="row">Deploy to Artifactory</th>
                <td>On this step, the main smart mirror app is built and deployed to artifactory, configured on the settings.xml file. </td>
                <td>Maven<br> </td>
                <td>Test + Deploy <br> Deploy</td>
            </tr>
            
            <tr>
                <th scope="row">Deploy back-end</th>
                <td>Builds a docker image containing our emotion detection program and pushes it to the docker registry </td>
                <td>Docker<br> </td>
                <td>Test + Deploy <br> Deploy</td>
            </tr>
            
            <tr>
                <th scope="row">Deploy Doctor App</th>
                <td>Builds the doctor app and the corresponding docker image. It pushes the image to the docker registry. </td>
                <td>Docker </td>
                <td>Test + Deploy <br> Deploy</td>
            </tr>
            
            <tr>
                <th scope="row">Cucumber Tests</th>
                <td>On this step, the integration tests are executed to check the integrity of the data flows. </td>
                <td>Maven and Cucumber </td>
                <td>Test + Deploy <br> Test</td>
            </tr>
            
            <tr>
                <th scope="row">Deploy on runtime</th>
                <td>In this step the pipeline gets the app running on the runtime server. To do so, it uses an sshagent to connect to the server. Afterwards, it runs a pre-existing script to clean the currently running containers, if there’s any. Then, it fetches the Smart Mirror artifact from artifactory and transfers the Dockerfile from Jenkins, using it to build the docker image and finally it runs the container. To finish, it pulls the emotion detection and doctor app images from the docker registry and runs them. </td>
                <td>SSH command </td>
                <td>Test + Deploy <br> Deploy</td>
            </tr>
            
            <tr>
                <th scope="row">Prepare Reports</th>
                <td>On this step, the pipeline saves the cucumber tests reports, so they can be consulted on the Jenkins page. </td>
                <td>Cucumber Reports Jenkins plugin </td>
                <td>Test + Deploy <br> Test</td>
            </tr>
            
        </tbody>
    </table>
</div>

<div id="details">
    <div class="title">
        <h3>Requirements</h3>
        <h4>Notes on requirements for the pipeline to work</h4>
    </div>
    To deploy and run SmartMirror, we need the following running containers:
    <ul>
        <li>Kafka Broker, running on port <code>9093</code></li>
        <li>MySQL, running on port <code>3037</code></li>
        <li>A fully configured ELK Stack</li>
    </ul>
    Also, even if it's not part of the pipeline itself, the system has specific hardware requirements on the client side:
    <ul>
        <li>Camera</li>
        <li>Microphone</li>
    </ul>
</div>

<div id="diagram">
    <div class="title">
    <h2>Monitoring</h2>
    </div>

    <img class="center" src="assets/images/monitoring-example.png" alt="Example of monitoring data that can be visualized on Kibana" style="max-width:100%;
    max-height:100%;"></img>
    <p class="text-muted" style="text-align: center">
        Example of monitoring data that can be visualized on Kibana
    </p>

    The monitoring is done using the ELK stack (<i>Elasticsearch Logstash Kibana</i>).<br><br>
    
    To upload our data to Elastic Search, we’re using a appender for logback. This appender is configured on the <code>logback.xml</code>, available on the source code. <br><br>
    
    This data can then be visualized on Kibana, by consulting the index <code>“esp30-logs”</code>. 
As all our logs messages are uploaded there, <b>this data can be filtered to show all kinds of information about the running system, from status to the emotions being captured.</b>

</div>

        

              
              <br>
              <a class="sidebar-nav-item" href="#" data-proofer-ignore><h5 data-toc-skip><i class="material-icons">arrow_upward</i> Return to Top</h5></a>
          </div>
           
      </div> 
    </div>
  </div>
</div>
 
  
  <!-- Footer -->
  <footer class="footer footer-default">
    <div class="container">
      <nav class="float-left">
        <ul>
          <li>
            <a> Smart Mirror - Make your life easier</a>
          </li>
        </ul>
      </nav>
      <div class="copyright float-right">
        &copy;
        <script>
          document.write(new Date().getFullYear())
        </script>, made with <i class="material-icons">favorite</i> by
        Jorge, Marcelo, Fabio, Paulo, Pedro.
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <!--   Core JS Files   -->
  <script src="./assets/js/core/jquery.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/popper.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
  <script src="./assets/js/plugins/moment.min.js"></script>
  <!--	Plugin for the Datepicker, full documentation here: https://github.com/Eonasdan/bootstrap-datetimepicker -->
  <script src="./assets/js/plugins/bootstrap-datetimepicker.js" type="text/javascript"></script>
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="./assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
  <!--  Google Maps Plugin    -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDGat1sgDZ-3y6fFe6HD7QUziVC6jlJNog"></script>
  <!--	Plugin for Sharrre btn -->
  <script src="./assets/js/plugins/jquery.sharrre.js" type="text/javascript"></script>
  <!-- Control Center for Material Kit: parallax effects, scripts for the example pages etc -->
  <script src="./assets/js/material-kit.min.js?v=2.0.5" type="text/javascript"></script>
  <!-- Place this tag in your head or just before your close body tag. -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  
  <!-- TOC -->
  <!-- add after bootstrap.min.css -->
  <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
  <!-- add after bootstrap.min.js -->
  <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script>

  <!-- Tooltips -->
  <script>
  $('a[data-toggle="tooltip"]').tooltip({
    animated: 'fade',
    placement: 'bottom',
    html: true
  });
  </script>
</body>

</html>
